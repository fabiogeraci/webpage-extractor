{% extends "base.html" %}
{% block content %}
    <h1>Webpage Extractor</h1>
    <p class="muted">Extract main text to Markdown and images (resized to 800×800). Choose a destination folder.</p>
    
    <div class="card">
        <form method="post" action="/extract">
            <div class="row">
                <div>
                    <label for="url">Page URL</label>
                    <input type="url" id="url" name="url" placeholder="https://example.com/article" required />
                </div>
                
                <div>
                    <label for="destination">Destination Folder</label>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <input type="text" id="new_destination" name="new_destination" placeholder="e.g., /home/user/Documents/my-extractions or C:\Users\you\Documents\my-extractions" style="flex: 1;" />
                    </div>
                    <small class="muted">Enter the full absolute path where extracted content will be saved.</small>
                </div>
            </div>
            
            <div style="margin-top:1rem">
                <button type="submit">Extract</button>
            </div>
        </form>
    </div>

    {% if error %}
        <div style="background: #ffebee; border: 1px solid #f44336; border-radius: 8px; padding: 1rem; margin-top: 1rem;">
            <h3 style="color: #d32f2f; margin: 0 0 0.5rem 0;">❌ Error</h3>
            <p style="margin: 0; color: #d32f2f;">{{ error }}</p>
        </div>
    {% endif %}

    {% if result %}
        <div style="background: #e8f5e8; border: 1px solid #4CAF50; border-radius: 8px; padding: 1rem; margin-top: 1rem;">
            <h3 style="color: #2e7d32; margin: 0 0 0.5rem 0;">✅ Extraction Complete!</h3>
            <p style="margin: 0; color: #2e7d32;"><strong>Saved images:</strong> {{ result.image_filenames|length }}</p>
            <p style="margin: 0; color: #2e7d32;"><strong>Files saved to:</strong> The destination folder you specified</p>
        </div>
        
        <h2>Markdown Preview</h2>
        <pre style="background: #f5f5f5; padding: 1rem; border-radius: 8px; overflow-x: auto;">{{ result.markdown }}</pre>
    {% endif %}

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const destinationInput = document.getElementById('new_destination');
            destinationInput.addEventListener('input', function() {
                if (this.value.trim()) {
                    this.style.borderColor = '#2196F3';
                } else {
                    this.style.borderColor = '';
                }
            });
        });
    </script>
{% endblock %}